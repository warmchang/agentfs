http_port 3128

# DNS
dns_v4_first on

# Allowed domains
acl allowed dstdomain \
    .modelcontextprotocol.io \
    .static.rust-lang.org \
    .pythonhosted.org \
    .pypi.org \
    .crates.io \
    .npmjs.org \
    .github.com \
    .githubusercontent.com \
    .go.dev \
    .golang.org \
    .anthropic.com \
    .openai.com \
    .sentry.io \
    .statsig.com \
    .visualstudio.com \
    .windows.net \
    .jetbrains.com \
    .googleapis.com

# Allow HTTPS CONNECT only to allowed domains
acl SSL_ports port 443
acl Safe_ports port 80 443
acl CONNECT method CONNECT

http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports
http_access allow allowed
http_access deny all

# Logging
access_log stdio:/var/log/squid/access.log
